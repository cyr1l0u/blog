---
url: /2013/07/more-private-as-numbers.html
title: "More private AS numbers"
date: "2013-07-30T06:53:00.000+02:00"
tags: [ DMVPN,BGP,MPLS VPN ]
---

<p>Have you ever tried to implement a large-scale DMVPN or MPLS/VPN network using BGP as the routing protocol? If you tried to stitch more than ~1000 sites together you’re well aware of all the pain caused by a <a href="http://tools.ietf.org/html/rfc1930">small range of private AS numbers defined in RFC 1930</a>. We can kludge our way around the limitation by reusing the same AS number on multiple sites (and using <strong>allowas-in </strong>when we need full routing information on every site), but such a design clearly sucks.<!--more--></p>
<p>RFC 6996 (published a few days ago) neatly solves the problem: it adds a new range of 32-bit private AS numbers from 4200000000 to 4294967294. I’m positive I won’t be able to remember the number of zeroes in the first number, but fortunately we can still use <em>asdot </em>notation (even though it’s been <a href="http://www.ietf.org/rfc/rfc5396.txt">discouraged by RFC 5396</a>), where the private AS numbers go from 64086.59904 to 65535.65534. For all practical purposes, you could use 65000.1 through 65500.65500 and have enough AS numbers to address all your future DMVPN-connected sites throughout the solar system.</p>
<p>And finally a few warnings:</p>
<ul class="ListParagraph"><li>Your CE-routers obviously have to support 4-byte AS numbers, which means you need reasonably new Cisco IOS (or IOS XE), and I’m not sure what other vendors are doing (but please do feel free to write a comment);</li>
<li>The BGP code dealing with private AS numbers (example: <strong>neighbor remove-private-as </strong>functionality) probably won’t recognize the new AS numbers for quite a while. Don’t use the 32-bit private AS numbers if there’s a direct path of BGP speakers between your sites and the public internet.</li>
</ul>

