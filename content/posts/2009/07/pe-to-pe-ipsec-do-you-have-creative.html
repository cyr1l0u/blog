---
title: "PE-to-PE IPSec: do you have creative ideas?"
date: "2009-07-16T06:54:00.005+02:00"
tags: [ security,MPLS VPN ]
---

<div class="bloggerBody"><p>Ying would like to have a PE-to-PE IPSec protection for traffic within a single VRF. For example, all traffic in VRF-A sent between PE-1 and PE-2 should be protected with IPSec and the PE-routers should be the endpoints of the IPSec session (CE-to-CE IPSec is trivial).</p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_K_pkZO5-tTg/SlhFcDvnzKI/AAAAAAAADg4/k95uehGL7NU/s1600-h/PE-PE+IPSec.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_K_pkZO5-tTg/SlhFcDvnzKI/AAAAAAAADg4/k95uehGL7NU/s400/PE-PE+IPSec.png" /></a></div>
<p>My first response was “hard to do”, then I started hallucinating about MPLS-over-GRE-over-IPSec-over-IP-over-MPLS tunnels between the PE-routers with tunnel-specific IGP and per-VRF BGP next hops. It can be done (we’ve implemented numerous large-scale MPLS/GRE/IPSec designs), but is there a simpler alternative? Please share your ideas in the comments.</p>
</div>

