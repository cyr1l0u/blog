---
title: "Is OSPF Unpredictable or Just Unexpected?"
date: "2018-04-26T07:52:00.000+02:00"
tags: [ OSPF,SDN,IP routing ]
---

<p>I was listening to very interesting <a href="http://packetpushers.net/podcast/podcasts/show-354-future-networking-fred-baker/">Future of Networking with Fred Baker</a> a long while ago and enjoyed Fred&rsquo;s perspectives and historical insight, until unfortunately Greg Ferro couldn&rsquo;t possibly resist the usual bashing of traditional routing protocols and praising of intent-based (or <a href="http://blog.ipspace.net/2015/11/packet-and-flow-based-forwarding.html">flow-based</a> or SDN or&hellip;) whatever.</p>
<p>Here&rsquo;s what I understood he said around 35:17<!--more--></p>
<blockquote class="cite">The problem with the dynamic or distributed algorithms is that they quite often do unexpected things.</blockquote>
<p>You might think it was a Freudian slip-of-tongue, but it seems to be a persistent mantra. Recently it <a href="http://etherealmind.com/networking-complex-hard/">became</a> &ldquo;<em>a fallacy that a network will ever be reliable or predictable</em>.&rdquo;</p>
<p>Well, I totally believe that routing algorithms like OSPF would surprise Greg <a href="http://blog.ipspace.net/2017/01/ospf-forwarding-address-yet-another.html">or myself</a> (as I often admit during my <a href="http://www.ipspace.net/Hands-On_Network_Automation">network automation workshops</a>), but that only means that with all the nerd knobs we added they became too complex for mere mortals to intuitively grasp their behavior.</p>
<p class="note">On a side note, I would love to see how <a href="https://www.youtube.com/watch?v=ARJ8cAGm6JE"><em>expe</em><em>c</em><em>ted</em></a><em> </em>the results of complex intent-based systems will be.</p>
<p>Anyway, let&rsquo;s move from subjective <em>unexpected </em>to objective <em>unpredictable</em> or <em>non-deterministic</em>. </p>
<p>Interestingly, with the clear split between information distribution (LSA flooding) and route computation (SPF algorithm), link-state routing protocols are one of the most predictable distributed algorithms out there, and can in the worst-case scenario result in temporary forwarding loops due to eventual consistency of topology database.</p>
<p class="warn">Seemingly simpler hop-by-hop protocols like distance- or path vector routing protocols are much worse and can result in <a href="http://blog.ipspace.net/2013/10/can-bgp-route-reflectors-really.html">permanent forwarding loops</a> or <a href="https://rule11.tech/bgp-persistent-oscillation/">persistent oscillations</a>. </p>
<p>Assuming you have infinite patience, it&rsquo;s quite easy to predict what an OSPF network will look like:</p>
<ul class="ListParagraph"><li>Take topology database;</li>
<li>Follow all the intricate rules in various OSPF-related RFCs;</li>
<li>Get the final forwarding table.</li>
</ul>
<p class="note">Speaking about the intricate rules: many of them seem like Rube Goldberg fixes introduced to correct unexpected OSPF behavior, probably proving my &ldquo;<em>lack of intuitive grasp</em>&rdquo; hypothesis.</p>
<p>Nobody in his right mind would do something like that, but once the steps to a solution are well-defined, it&rsquo;s trivial (from the perspective of a mathematical proof, not the actual implementation) to carry them out&hellip; and there are tools like Cariden&rsquo;s MATE that do exactly that.</p>
<p>However, because it&rsquo;s easier to not spend money on something that would prevent an event with uncertain probability (network going down due to misconfigured OSPF, or losing customer data due to an intrusion), vendors like Cariden have relatively few customers, resulting in expensive tools.</p>
<p>Of course there&rsquo;s another way of dealing with the &ldquo;unexpectedness&rdquo; of OSPF: <a href="http://blog.ipspace.net/2013/08/temper-your-macgyver-streak.html">stop being a MacGyver</a>, forget the <a href="http://blog.ipspace.net/2015/08/musing-on-nerd-knobs.html">nerd knobs</a>, keep your network design <a href="http://blog.ipspace.net/2011/05/complexity-belongs-to-network-edge.html">as simple as possible</a>, and use the absolute minimum subset of features you need to get the job done. </p>
<p>Unfortunately, it seems like only a small minority of engineers or architects want to follow this particular advice. It&rsquo;s so much easier to <a href="http://blog.ipspace.net/2016/01/the-sad-state-of-enterprise-networking.html">believe</a> in <a href="http://blog.ipspace.net/2017/09/intent-based-hype.html">yet another technology wonder</a>.</p>

