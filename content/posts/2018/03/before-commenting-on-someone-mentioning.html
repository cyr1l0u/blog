---
title: "Reinventing SSL VPN (RFC 1925 Strikes Again)"
date: "2018-03-08T11:14:00.000+01:00"
tags: [ firewalls,security,VPN ]
---

<p>Some of my readers got annoyed when I <a href="http://blog.ipspace.net/2018/02/worth-reading-whiteboxes-for-everyone.html">mentioned</a> Google&rsquo;s BeyondCorp and RFC 1925 in the same sentence (to be perfectly clear, I had Rule#11 in mind). I totally understand that sentiment &ndash; reading the reactions from industry press it seems to be the best thing that happened to Enterprise IT in decades.</p>
<p>Let me explain in simple terms why I think it&rsquo;s not such a big deal and definitely not something new, let alone revolutionary.<!--more--></p>
<h4>Before moving on&hellip;</h4><p>Please note that although the idea itself is simple and old, Google engineers did another great engineering job (I would expect nothing less) &hellip; but in my grumpy opinion that still doesn&rsquo;t warrant the reactions we&rsquo;ve seen from salivating clueless fanboys. </p>
<p>It&rsquo;s also perfectly possible I&rsquo;ve missed something fundamental, in which case please write a comment. Oh, and just in case you want to get it straight from the source, <a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43231.pdf">here&rsquo;s the original article</a>. </p>
<h4>Back to the topic at hand&hellip;</h4><p>As always, let&rsquo;s start with The Problem. This time we have users connected to an untrusted network that want to access an application we care about (at least a bit). The &ldquo;only&rdquo; problem is that there are other people around who might also want to access that same application for nefarious purposes.</p>
<div class='separator'><a href="https://4.bp.blogspot.com/-dxBWitDSmss/WpUxjDbMXbI/AAAAAAAAJFE/lleiFlXRAewwlLTAqs61uj5WdlgUYgSGwCLcBGAs/s1600/BC-1.png" imageanchor="1" ><img border="0" src="https://4.bp.blogspot.com/-dxBWitDSmss/WpUxjDbMXbI/AAAAAAAAJFE/lleiFlXRAewwlLTAqs61uj5WdlgUYgSGwCLcBGAs/s550/BC-1.png" data-original-width="933" data-original-height="367" /></a></div>
<p>Nothing new, right? Well, the one thing Google BeyondCorp team nailed was admitting that the internal client networks aren&rsquo;t much safer than the global Internet, and decided to treat them (almost) the same.</p>
<p class='info'>You get mostly the same results once you move your internal workload to the $Cloud, so let's not pretend it's something revolutionary. <a href="http://www.ipspace.net/Author:Ed_Horley">Ed Horley</a> will speak about this particular can of worms in the June 2018 session of <a href="http://www.ipspace.net/Building_Next-Generation_Data_Center">Building Next-Generation Data Center</a> online course.</p>
<p>Anyway, back to the original problem. You can harden the application so it can survive the Big Bad Internet in all its &ldquo;glory&rdquo;. After all, there are all sorts of mission-critical applications accessible from the public Internet. Guess what &ndash; most people don&rsquo;t trust their internal applications (or their developers) enough to do that. Sometimes they <a href="https://en.wikipedia.org/wiki/Equifax#Security_failings">shouldn't trust even their public-facing application</a>, but that's a different story.</p>
<p>Step 1: let&rsquo;s solve the problem with a <a href="http://blog.ipspace.net/2018/02/anti-automation-from-antimatter-universe.html">hefty dose of voodoo magic aka Next-Generation Firewall</a>.</p>
<div class='separator'><a href="https://3.bp.blogspot.com/-WmfToZG3hv8/WpUxjLHI-qI/AAAAAAAAJFI/nduPitliMeEJNCtYAa2ke1yqGoHlt3C5QCLcBGAs/s1600/BC-2.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-WmfToZG3hv8/WpUxjLHI-qI/AAAAAAAAJFI/nduPitliMeEJNCtYAa2ke1yqGoHlt3C5QCLcBGAs/s550/BC-2.png" data-original-width="1023" data-original-height="297" /></a></div>
<p>Just for the sake of completeness &ndash; people who know what they&rsquo;re doing know that the first thing that will fall over when exposed to a decent DDoS attack will be the next-generation firewall so they <a href="http://blog.ipspace.net/2010/08/i-dont-need-no-stinking-firewall-or-do.html">invest in writing tight ACLs and hardening their servers and applications</a> instead of financing the vendors. Sorry, I&rsquo;m digressing&hellip;</p>
<p>Anyway, even the Next-Generation Firewalls are not good enough for most enterprise **applications. The powers that be want to make sure that only the authorized users can access those applications, naively hoping that all the authorized users are totally benevolent. Fat chance, but let&rsquo;s not go down that path. </p>
<p>Enter the wonderful world of VPNs &ndash; let&rsquo;s authenticate the users at a central point before admitting them into the network, and then use network-layer encryption to protect the data traversing less secure networks.</p>
<div class='separator'><a href="https://3.bp.blogspot.com/-hGQRhNHeIQ0/WpUxjBodzXI/AAAAAAAAJFA/aGfr4YiaKz4IRGlwUcthjI-jH1pL92GEQCLcBGAs/s1600/BC-3.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-hGQRhNHeIQ0/WpUxjBodzXI/AAAAAAAAJFA/aGfr4YiaKz4IRGlwUcthjI-jH1pL92GEQCLcBGAs/s550/BC-3.png" data-original-width="1022" data-original-height="288" /></a></div>
<p>Interestingly, you wouldn&rsquo;t need VPNs if only (A) all your applications would be accessible over TLS (next-generation SSL/HTTPS) and (B) you&rsquo;d have a centralized sign-on solution similar to whatever you&rsquo;re using to authenticate VPN users. You could use any browser on the client side and web proxy to ensure client communication is always encrypted&hellip; and that&rsquo;s BeyondCorp in the nutshell.</p>
<div class='separator'><a href="https://3.bp.blogspot.com/-tr0xPMqXHZE/WpUxj1y-rrI/AAAAAAAAJFM/3bcCRRS9VSMvFLRdZjeOz1qmmREnorV9gCLcBGAs/s1600/BC-4.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-tr0xPMqXHZE/WpUxj1y-rrI/AAAAAAAAJFM/3bcCRRS9VSMvFLRdZjeOz1qmmREnorV9gCLcBGAs/s550/BC-4.png" data-original-width="1026" data-original-height="300" /></a></div>
<p>Let&rsquo;s recap. Assuming everything you do is web-based:</p>
<ul class="ListParagraph"><li>Replace IPsec with TLS (HTTPS)</li>
<li>Throw away VPN clients (because all you need is a browser)</li>
<li>Pass all the traffic through a web proxy that handles user authentication and authorization.</li>
</ul>
<p>Oh, and a bonus idea:</p>
<ul class="ListParagraph"><li>Put the web proxy in front of the data center (between all client networks and web servers), not between Internet and the internal network, and you got BeyondCorp.</li>
</ul>
<p>Not only is this not revolutionary, I know people who have been doing similar things for decades.</p>
<p>As for other perceived benefits:</p>
<ul class="ListParagraph"><li>Yes, we got rid of VPN client&hellip; but guess what, you can&rsquo;t access anything that&rsquo;s not HTTP-based anymore. No problem, right?</li>
<li>We replaced VPN concentration with web proxies, but we still have a central chokepoint.</li>
<li>Traditional pointy-haired bosses wouldn&rsquo;t trust an internal team to get it done right; those environments would be back to buying $vendor appliances no matter what&hellip; or <a href="https://blog.cloudflare.com/introducing-cloudflare-access/">buy a service from someone like CloudFlare</a> (which is what I&rsquo;ll be doing the next time my VPN client falls over when faced with an IPv6 network).</li>
</ul>
<p>To summarize:</p>
<ul class="ListParagraph"><li>Whenever you read about something revolutionary on the Internet, there&rsquo;s a pretty high chance it isn&rsquo;t;</li>
<li>You can continue believing in Santa Claus and amazing power of technology (in which case I have a stock of blue pills for you), or decide to figure out what&rsquo;s really going on;</li>
<li>Find the original sources &ndash; most things you read about in industry press have been dumbed down beyond recognition. Can&rsquo;t find them after extensive search? Move on, it was probably just a publicity stunt. I also decided to ignore companies that <a href="http://blog.ipspace.net/2015/10/we-need-product-documentation-not-just.html">can&rsquo;t get the basic paperwork right</a> years ago &ndash; it does wonders when trying to figure out where to spend my time;</li>
<li>Read the original information and try to figure out where you&rsquo;ve seen similar ideas before. Based on that you&rsquo;ll be quickly able to figure out what going on behind the scenes and what the benefits and challenges of the technology or solution might be&hellip; and do keep in mind that <a href="http://www.circleid.com/posts/20171019_network_design_if_you_havent_found_the_tradeoff/">until you&rsquo;ve identified the tradeoffs you haven&rsquo;t looked hard enough</a>. Don&rsquo;t know <a href="http://blog.ipspace.net/2015/10/the-lack-of-historic-knowledge-is-so.html">enough networking history</a> to do it? Talk to the nearest grumpy greybeard ;)</li>
</ul>

