---
title: "Lack of Fast Convergence in SD-WAN Products"
date: "2018-03-01T09:21:00.000+01:00"
tags: [ SDN,IP routing,WAN ]
---

<p>One of my readers sent me this question:</p>
<blockquote class="cite">I'm in the process of researching SD-WAN solutions and have hit upon what I believe is a consistent deficiency across most of the current SD-WAN/SDx offerings.  The standard "best practice" seems to be 60/180 BGP timers between the SD-WAN hub and the network core or WAN edge. </blockquote>
<p>Needless to say, he wasn&rsquo;t able to find BFD in these products either. </p>
<p>Does that matter? My reader thinks it does:<!--more--></p>
<blockquote class="cite">When we consider that many companies will use these SD-WAN solutions to transport voice and real-time traffic, why is there a lack of focus on mechanisms which enable fast convergence at critical aggregation points?</blockquote>
<p>He definitely has a point, even without voice and real-time traffic requirements. Waiting three minutes to figure out an adjacent box is down definitely feels like a call from &lsquo;90s.</p>
<p>Or maybe we&rsquo;re missing something. The whole idea of SD-WAN was to take over the core WAN routing in your network. Tom Hollingsworth has an interesting story<a href="https://networkingnerd.net/2018/01/19/can-routing-be-oversimplified/"> in one of his blog posts</a>:</p>
<blockquote class="cite">We turned off OSPF and now have a /16 route for the internal network and a default route to the Internet where a lot of our workloads were moved into the cloud.</blockquote>
<p>We&rsquo;ve seen similar claims in the past. Remember MPLS/VPN and the nirvana you&rsquo;ll reach once the Service Provider takes over your core routing? Yeah, it didn&rsquo;t turn out exactly that way, did it?</p>
<p>Anyway, assuming we give a proprietary black-box system with no publicly-accessible documentation total control of our core network should we care about the routing protocols at the edge of the black haze?</p>
<p class="info">SilverPeak and Viptela are notable exceptions: <a href="https://www.silver-peak.com/support/user-documentation">SilverPeak documentation</a>, <a href="https://docs.viptela.com/Product_Documentation">Viptela documentation</a>. Anyone else? Write a comment!</p>
<p>If you&rsquo;re deploying a single SD-WAN appliance per site, and it controls all uplinks, the answer is obviously NO. There&rsquo;s a single exit point (SD-WAN appliance) and it&rsquo;s either working or not.</p>
<div class='separator'><a href="https://2.bp.blogspot.com/-BKfmF7HRgNY/Wo-5B4kTArI/AAAAAAAAJEc/Syv-k6En77cIkbbljQlnq0UgWGRUJZrOwCLcBGAs/s1600/Small%2Bsite.png" imageanchor="1" ><img border="0" src="https://2.bp.blogspot.com/-BKfmF7HRgNY/Wo-5B4kTArI/AAAAAAAAJEc/Syv-k6En77cIkbbljQlnq0UgWGRUJZrOwCLcBGAs/s600/Small%2Bsite.png" data-original-width="1097" data-original-height="300" /></a></div>
<p>If you&rsquo;re deploying redundant SD-WAN appliances on a site that needs higher availability and these appliances work as a cluster, control all the uplinks, and use layer-2 tricks (usually VRRP) to give the impression of a single next-hop router to the site network, the answer is still NO. We&rsquo;re doing the same thing with static default routes pointing to a shared IP address of a firewall cluster today. I&rsquo;m not saying it&rsquo;s a good idea, but some people would probably claim it&rsquo;s the best practice.</p>
<div class='separator'><a href="https://4.bp.blogspot.com/-FriFXKI-7Dc/Wo-5BfOyj5I/AAAAAAAAJEY/-YcxsGOhJ3MEHZtSCeQY1l6YFNHldPCPwCLcBGAs/s1600/Redundant%2Blayer-2%2Bsite.png" imageanchor="1" ><img border="0" src="https://4.bp.blogspot.com/-FriFXKI-7Dc/Wo-5BfOyj5I/AAAAAAAAJEY/-YcxsGOhJ3MEHZtSCeQY1l6YFNHldPCPwCLcBGAs/s600/Redundant%2Blayer-2%2Bsite.png" data-original-width="1101" data-original-height="342" /></a></div>
<p>Unfortunately some SD-WAN vendors believe they can use the same approach no matter what. Their appliances try to avoid routing protocols like black plague and use dirty tricks like VRRP between SD-WAN appliance and on-site router combined with static default routing to get the appearance of primary/backup behavior. How many times do we have to repeat the same mistakes?</p>
<div class='separator'><a href="https://3.bp.blogspot.com/-nO7ONNtoyQs/Wo-5Be1KikI/AAAAAAAAJEg/Sq1oaBOOfOEI76ubNaykovgm-x7B4htRACLcBGAs/s1600/Site%2Bwith%2BRedundant%2BUplinks.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-nO7ONNtoyQs/Wo-5Be1KikI/AAAAAAAAJEg/Sq1oaBOOfOEI76ubNaykovgm-x7B4htRACLcBGAs/s600/Site%2Bwith%2BRedundant%2BUplinks.png" data-original-width="1100" data-original-height="370" /></a></div>
<p>However, if you do run routing protocol between SD-WAN appliances and other routers on your site for whatever reason (failover, alternate uplinks&hellip;), then I guess we deserve a decent implementation of the said routing protocols. It&rsquo;s not like you couldn&rsquo;t get a routing protocol suite these days, either as open-source project or a commercial product.</p>
<div class='separator'><a href="https://4.bp.blogspot.com/-bCjyaBDdgEI/Wo-5BRQeL1I/AAAAAAAAJEU/NAbJermIVFknXFkQA5IcmUnnIu_Imbq-gCLcBGAs/s1600/Large%2BSite%2Bwith%2BRouting.png" imageanchor="1" ><img border="0" src="https://4.bp.blogspot.com/-bCjyaBDdgEI/Wo-5BRQeL1I/AAAAAAAAJEU/NAbJermIVFknXFkQA5IcmUnnIu_Imbq-gCLcBGAs/s600/Large%2BSite%2Bwith%2BRouting.png" data-original-width="1101" data-original-height="329" /></a></div>
<p>Or maybe the SD-WAN vendors don&rsquo;t have to care because they&rsquo;re never asked about such mundane details. There must be plenty of customers believing in <a href="http://blog.ipspace.net/2011/09/long-distance-irf-fabric-works-best-in.html">magic powers of PowerPoint</a> out there&hellip;</p>
<p class='update'>2018-06-18: Added link to Viptela's online documentation</p>
<h4>Want to know more?</h4><p>I covered the basics of SD-WAN in <a href="http://www.ipspace.net/Choose_the_Optimal_VPN_Service">Choose the Optimal VPN Service</a> and <a href="http://www.ipspace.net/SDN_Use_Cases">SDN Use Cases</a> webinars, and we'll do <a href="https://www.ipspace.net/SDWAN">SDWAN 101</a> webinar in September 2018. All three webinars are included in the <a href="http://www.ipspace.net/Subscription">ipSpace.net Webinar Subscription</a>.</p>

