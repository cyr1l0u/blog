---
url: /2008/08/ospf-in-vrf-requires-box-unique-router.html
title: "OSPF in a VRF requires a box-unique router ID"
date: "2008-08-01T07:00:00.000+02:00"
tags: [ OSPF,MPLS VPN ]
---

<div class="bloggerBody"><p>It's obvious why two routers in the same OSPF domain cannot have the same router ID. But requiring unique router IDs on OSPF processes running in different VRFs is probably too harsh, although it does prevent confusion if two VRFs ever get connected through a customer site. Anyhow, if you have overlapping IP addresses on loopback interfaces in <em>different VRFs</em>, OSPF process might not start.</p>
<!--more--><p>Here's a short example: two VRFs have loopback interfaces with the same IP address. Perfectly legal setup from the MPLS/VPN perspective.</p>
<pre class="code">c7200#<strong>show </strong><strong>ip</strong><strong> </strong><strong>vrf</strong><strong> interfaces</strong><br/>Interface    IP-Address   VRF            Protocol<br/>Lo1003       10.0.0.1     EIGRP_OSPF     up<br/>Lo1001       10.0.0.1     OSPF_1         up</pre><p>However, when you try to configure the second OSPF process, it fails to start as it cannot get a box-unique router ID. You have to enter a different router ID manually.</p>
<pre class="code">c7200#<strong>conf t</strong><br/>Enter configuration commands, one per line.  End with CNTL/Z.<br/>c7200(config)#<strong>router </strong><strong>ospf</strong><strong> 1 vrf OSPF_1</strong><br/>c7200(config-router)#<strong>network 0.0.0.0 255.255.255.255 area 0</strong><br/>c7200(config-router)#<strong>exit</strong><br/>c7200(config)#<strong>router </strong><strong>ospf</strong><strong> 3 vrf EIGRP_OSPF</strong><br/>%OSPF-4-NORTRID: OSPF process 3 cannot pick a router-id.<br/>  Please configure manually or bring up an interface with an ip address.<br/>c7200(config-router)#<strong>router-id 10.0.0.2</strong></pre></div>

