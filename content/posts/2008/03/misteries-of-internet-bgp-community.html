---
title: "The misteries of the “Internet” BGP community"
date: "2008-03-13T07:11:00.001+01:00"
tags: [ BGP ]
---

The <a href="http://www.ethanbanks.net/?p=379">post by Ethan Banks</a> reminded me of a “mystery” I was trying to solve years ago when developing my first BGP course. The <a href="http://www.cisco.com/en/US/docs/ios/iproute/command/reference/irp_bgp2.html#wp1016057">Cisco documentation has always claimed there were four well-known communities</a> (the <em>Internet</em> community being one of them), while the <a href="http://tools.ietf.org/html/rfc1997">RFC 1997 lists three well-known values</a>. Unfortunately, most people blindly copy the IOS documentation (including the authors of the <a href="http://www.nil.com/C1256F620032CACB/NILLookup/BGP32">latest revision of the Cisco’s BGP course</a>) without asking themselves “what the heck is the <em>Internet</em> community”.<p class='note'>I don’t remember when exactly I’ve created the BGP community chapter of that BGP course, but I was able to fetch <a href="http://web.archive.org/web/19991002044555/www.nil.si/412565BD004B55E0/html/abct">a very old BGP course description</a> from <a href="http://web.archive.org/">the Internet Archives</a> … and by that time, the course was in its fifth or sixth revision. It must have been 10 years ago.</p>It was time to revisit the mystery. I’ve tried applying the <em>Internet</em> community to a network originated by the BGP routing process to see what its value is:<pre class='code'>router bgp 65000<br />&nbsp;network 192.168.1.0 route-map SetInternet<br />!<br />route-map SetInternet<br />&nbsp;set community internet additive<br /></pre><p>While the router obediently attached the <em>Internet</em> community to the IP prefix, I was no wiser … all show outputs converted the community value into its symbolic name. I had to use Wireshark and analyze the actual routing updates between BGP neighbors to figure out that the <em>Internet</em> community has an illegal value 0:0. Obviously it’s not a well-known community.</p>
<p class="info">If you're looking for more in-depth BGP knowledge, try our <a href="http://www.nil.si/ls/BS_BGP32?showlp">Configuring BGP on Cisco Routers</a> <a href="http://www.nil.si/C1256F0A00429755/html/bs_portfolio">e-learning solution</a>. If you just need to enhance your hands-on skill, the <a href="http://www.nil.si/ls/LB_RL_BGP32?showlp">BGP Remote Lab Bundle</a> is the perfect choice.</p>
<p>Digging through old materials finally gave me the answer I was looking for: sometimes you need a <em>permit all</em> at the end of the <strong>ip community-list</strong> (like access-lists, the community-lists have an implicit <em>deny all</em> at the end) and someone decided that <strong>permit internet</strong> makes more sense than the familiar <strong>permit any</strong> (yes, that’s correct … you use the keyword <strong>internet</strong> to match <em>any community</em> in the <strong>ip community-list</strong>).<br /><br />And just for the sake of completeness, let me conclude with a ten year old slide explaining this phenomenon:</p>
<a href="http://bp2.blogger.com/_K_pkZO5-tTg/R9ZkR7cnISI/AAAAAAAABQw/wtqYMfDY5AQ/s1600-h/bgpCommunity.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://bp2.blogger.com/_K_pkZO5-tTg/R9ZkR7cnISI/AAAAAAAABQw/wtqYMfDY5AQ/s320/bgpCommunity.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5176435080887214370" /></a><p class='info'>Cisco partners and employees can access the <a href="http://cisco.partnerelearning.com/pec/Direct.asp?URL=20111042128435.1231">BGP Communities remote lab</a> free-of-charge on the <a href="http://cisco.partnerelearning.com/">Partner Education Connection</a>.</p>

