---
title: "Conditional OSPF default route: tested configuration"
date: "2007-08-01T07:47:00.002+02:00"
tags: [ OSPF,IP routing ]
---

One of my readers asked for a working configuration of the <a href="http://ioshints.blogspot.com/2007/06/ospf-default-route-design-scenarios.html">conditional OSPF default route advertisment feature</a>. In my scenario, the OSPF default route would be announced whenever an Internet prefix (172.18.0.0/16) would be present in the IP routing table.<pre class='code'>router ospf 1<br />&nbsp;log-adjacency-changes<br />&nbsp;network 0.0.0.0 255.255.255.255 area 0<br />&nbsp;default-information originate always route-map FromInternet<br />!<br />router bgp 11<br />&nbsp;bgp log-neighbor-changes<br />&nbsp;neighbor 172.16.1.2 remote-as 21<br />!<br />ip access-list standard FromInternet<br />&nbsp;permit 172.18.0.0<br />!<br />route-map FromInternet permit 10<br />&nbsp;match ip address FromInternet</pre><div class='warn'>Caveats:<br /><ul><li>The route map configured in the <strong>default-information originate</strong> command tests the IP prefixes in the IP routing table. You can thus match only on those attributes that are present in the IP routing table (IP prefix, metric, next-hop), not on additional BGP attributes (like AS-path), which would be really cool</li>
<li>Contrary to what <a href="http://ioshints.blogspot.com/2007/06/ospf-default-route-design-scenarios.html#comment-5507351136262865205">Sebastian wrote in his comment</a>, you don't have to redistribute BGP route into OSPF to make it work in IOS release 12.4(11)T or 12.2SRC, but the IP prefix you test cannot be a subnet.</li>
</ul>
</div>
<p class='more'>This article is part of <a href="http://ioshints.blogspot.com/2007/01/youve-asked-for-it-series.html">You've asked for it</a> <a href="http://ioshints.blogspot.com/search/label/You%27ve%20asked%20for%20it">series</a>.</p>

