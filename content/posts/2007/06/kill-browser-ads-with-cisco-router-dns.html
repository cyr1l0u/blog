---
title: "Kill browser ads with Cisco router's DNS server"
date: "2007-06-15T09:17:00.000+02:00"
tags: [ DNS ]
---

<p><a href="http://www.nil.com/ipcorner"><img src="http://www.nil.com/C1256F0A00429755/free_tips_IP_Corner.gif" style="float: right; margin: 2px 0px 6px 3px; border-width: 0px;" /></a>As you might already know, you can use the <a href="http://www.mvps.org/winhelp2002/hosts.htm">/etc/hosts</a> file (or its <a href="http://en.wikipedia.org/wiki/Hosts_file#Location_and_layout">Windows equivalent</a>) to kill unwanted browser ads - just list all the banner-serving sites in you hosts file and set their IP addresses to 127.0.0.1. In my June <a href="http://www.nil.com/ipcorner">IP Corner</a> article, <a href="http://www.nil.com/ipcorner/RouterDNS/">Cisco Router: the Swiss Army Knife of Network Services</a> (section <em>Stop the browser ads and banners</em>), I'm describing how you can do the same thing network-wide with a router acting as a DNS server.<!--more--></p>
<p>For those of you who would like to automate this approach and convert <a href="http://www.mvps.org/winhelp2002/hosts.htm">a hosts file</a> into a router configuration, here's a short PERL script to do it. To run it, save the source into hostsToCisco.pl and start the script with <strong>perl hostsToCisco.pl <em>hostsFileName</em></strong>.</p>
<pre class='code'>#<br /># hostsToCisco.pl: converts hosts file into router configuration<br />#<br /># Stdin: hosts file<br /># Stdout: IOS configuration<br />#<br />our @line,$i;<br /><br />while (<>) {<br />  @line = split(/\s+/,$_);<br />  next unless $line[0] eq "127.0.0.1";<br />  for ($i = 1; $i < $#line; $i++) {<br />    last if $line[$i] =~ /\#/;<br />    print "ip host $line[$i] 127.0.0.1\n"<br />  }<br />}</pre><script>endHide()</script>

