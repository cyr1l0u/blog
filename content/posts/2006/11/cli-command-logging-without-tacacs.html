---
title: "CLI command logging without TACACS+"
date: "2006-11-07T15:56:00.000+01:00"
tags: [ syslog,access control,logging,EEM ]
---

The AAA architecture of Cisco IOS contains a number of very useful features, including the ability to authorize and log every CLI command executed on the router. Unfortunately, the <em>AAA command accounting</em> only supports TACACS+ as the AAA transport protocol, making it unusable in environments using RADIUS.<br /><br />You can use Embedded Event Manager as a workaround. The following configuration commands will log every command executed on the router. <br /><blockquote class="code">event manager applet CLIaccounting<br /> event cli pattern ".*" sync no skip no<br /> action 1.0 syslog priority informational msg "$_cli_msg"<br /> set 2.0 _exit_status 1</blockquote>The log messages generated by this EEM applet have the following format:<blockquote class="code">%HA_EM-6-LOG: CLIaccounting: <em>command</em></blockquote>As the EEM uses standard IOS logging mechanisms, you can use the <strong>show logging</strong> command to examine the command execution history or store the messages on a <em>syslog</em> server.<br /><br /><strong>Note:</strong> As a side effect, all commands executed on a router will be echoed to the router's console, unless you disable console logging with <strong>no logging console</strong> command or use TCL-based syslog filters (more about them in an upcoming post).

